{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Copyright 2019, Optimizely\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar js_sdk_logging_1 = require(\"@optimizely/js-sdk-logging\");\n\nvar pendingEventsStore_1 = require(\"./pendingEventsStore\");\n\nvar js_sdk_utils_1 = require(\"@optimizely/js-sdk-utils\");\n\nvar logger = js_sdk_logging_1.getLogger('EventProcessor');\n\nvar PendingEventsDispatcher =\n/** @class */\nfunction () {\n  function PendingEventsDispatcher(_a) {\n    var eventDispatcher = _a.eventDispatcher,\n        store = _a.store;\n    this.dispatcher = eventDispatcher;\n    this.store = store;\n  }\n\n  PendingEventsDispatcher.prototype.dispatchEvent = function (request, callback) {\n    this.send({\n      uuid: js_sdk_utils_1.generateUUID(),\n      timestamp: js_sdk_utils_1.getTimestamp(),\n      request: request\n    }, callback);\n  };\n\n  PendingEventsDispatcher.prototype.sendPendingEvents = function () {\n    var _this = this;\n\n    var pendingEvents = this.store.values();\n    logger.debug('Sending %s pending events from previous page', pendingEvents.length);\n    pendingEvents.forEach(function (item) {\n      try {\n        _this.send(item, function () {});\n      } catch (e) {}\n    });\n  };\n\n  PendingEventsDispatcher.prototype.send = function (entry, callback) {\n    var _this = this;\n\n    this.store.set(entry.uuid, entry);\n    this.dispatcher.dispatchEvent(entry.request, function (response) {\n      _this.store.remove(entry.uuid);\n\n      callback(response);\n    });\n  };\n\n  return PendingEventsDispatcher;\n}();\n\nexports.PendingEventsDispatcher = PendingEventsDispatcher;\n\nvar LocalStoragePendingEventsDispatcher =\n/** @class */\nfunction (_super) {\n  __extends(LocalStoragePendingEventsDispatcher, _super);\n\n  function LocalStoragePendingEventsDispatcher(_a) {\n    var eventDispatcher = _a.eventDispatcher;\n    return _super.call(this, {\n      eventDispatcher: eventDispatcher,\n      store: new pendingEventsStore_1.LocalStorageStore({\n        // TODO make this configurable\n        maxValues: 100,\n        key: 'fs_optly_pending_events'\n      })\n    }) || this;\n  }\n\n  return LocalStoragePendingEventsDispatcher;\n}(PendingEventsDispatcher);\n\nexports.LocalStoragePendingEventsDispatcher = LocalStoragePendingEventsDispatcher;","map":{"version":3,"sources":["/home/abhishek/Music/contentstack-reactjs-ab-testing/node_modules/@optimizely/js-sdk-event-processor/lib/pendingEventsDispatcher.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","exports","value","js_sdk_logging_1","require","pendingEventsStore_1","js_sdk_utils_1","logger","getLogger","PendingEventsDispatcher","_a","eventDispatcher","store","dispatcher","dispatchEvent","request","callback","send","uuid","generateUUID","timestamp","getTimestamp","sendPendingEvents","_this","pendingEvents","values","debug","length","forEach","item","e","entry","set","response","remove","LocalStoragePendingEventsDispatcher","_super","call","LocalStorageStore","maxValues","key"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright 2019, Optimizely\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar js_sdk_logging_1 = require(\"@optimizely/js-sdk-logging\");\nvar pendingEventsStore_1 = require(\"./pendingEventsStore\");\nvar js_sdk_utils_1 = require(\"@optimizely/js-sdk-utils\");\nvar logger = js_sdk_logging_1.getLogger('EventProcessor');\nvar PendingEventsDispatcher = /** @class */ (function () {\n    function PendingEventsDispatcher(_a) {\n        var eventDispatcher = _a.eventDispatcher, store = _a.store;\n        this.dispatcher = eventDispatcher;\n        this.store = store;\n    }\n    PendingEventsDispatcher.prototype.dispatchEvent = function (request, callback) {\n        this.send({\n            uuid: js_sdk_utils_1.generateUUID(),\n            timestamp: js_sdk_utils_1.getTimestamp(),\n            request: request,\n        }, callback);\n    };\n    PendingEventsDispatcher.prototype.sendPendingEvents = function () {\n        var _this = this;\n        var pendingEvents = this.store.values();\n        logger.debug('Sending %s pending events from previous page', pendingEvents.length);\n        pendingEvents.forEach(function (item) {\n            try {\n                _this.send(item, function () { });\n            }\n            catch (e) { }\n        });\n    };\n    PendingEventsDispatcher.prototype.send = function (entry, callback) {\n        var _this = this;\n        this.store.set(entry.uuid, entry);\n        this.dispatcher.dispatchEvent(entry.request, function (response) {\n            _this.store.remove(entry.uuid);\n            callback(response);\n        });\n    };\n    return PendingEventsDispatcher;\n}());\nexports.PendingEventsDispatcher = PendingEventsDispatcher;\nvar LocalStoragePendingEventsDispatcher = /** @class */ (function (_super) {\n    __extends(LocalStoragePendingEventsDispatcher, _super);\n    function LocalStoragePendingEventsDispatcher(_a) {\n        var eventDispatcher = _a.eventDispatcher;\n        return _super.call(this, {\n            eventDispatcher: eventDispatcher,\n            store: new pendingEventsStore_1.LocalStorageStore({\n                // TODO make this configurable\n                maxValues: 100,\n                key: 'fs_optly_pending_events',\n            }),\n        }) || this;\n    }\n    return LocalStoragePendingEventsDispatcher;\n}(PendingEventsDispatcher));\nexports.LocalStoragePendingEventsDispatcher = LocalStoragePendingEventsDispatcher;\n"]},"metadata":{},"sourceType":"script"}